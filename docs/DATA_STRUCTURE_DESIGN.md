# Flowlet æ•°æ®ç»“æ„è®¾è®¡ä¸ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

Flowlet æä¾›äº†ä¸€å¥—å®Œæ•´çš„æ•°æ®ç»“æ„å®šä¹‰å’Œç®¡ç†ç³»ç»Ÿï¼Œç”¨äºè§„èŒƒåŒ–èŠ‚ç‚¹è¾“å‡ºã€å¢å¼ºç±»å‹å®‰å…¨ã€æå‡æµç¨‹å¼€å‘ä½“éªŒã€‚æ”¯æŒ**å…¨å±€ï¼ˆé¡¹ç›®çº§ï¼‰**å’Œ**æµç¨‹çº§**ä¸¤ç§ä½œç”¨åŸŸï¼Œå¹¶æ”¯æŒ**æ³›å‹å®šä¹‰**æ¥å¤„ç†é€šç”¨çš„æ•°æ®æ¨¡å¼ã€‚

---

## æ ¸å¿ƒæ¦‚å¿µ

### 1. ä½œç”¨åŸŸ (Scope)

| ä½œç”¨åŸŸç±»å‹              | è¯´æ˜                       | ä½¿ç”¨åœºæ™¯                                                          | æ ‡è¯†                     |
| ----------------------- | -------------------------- | ----------------------------------------------------------------- | ------------------------ |
| **é¡¹ç›®çº§ (Global)**     | åœ¨æ•´ä¸ªé¡¹ç›®èŒƒå›´å†…å¯è§å’Œå¤ç”¨ | é€šç”¨ä¸šåŠ¡æ¨¡å‹ï¼ˆå¦‚ Userã€Orderï¼‰<br>é€šç”¨å“åº”ç»“æ„ï¼ˆå¦‚ Resultã€Pageï¼‰ | `global.StructureName`   |
| **æµç¨‹çº§ (Flow-level)** | ä»…åœ¨ç‰¹å®šæµç¨‹å†…å¯è§         | æµç¨‹ä¸“å±çš„ä¸´æ—¶æ•°æ®ç»“æ„                                            | `FlowName.StructureName` |

**ç‰¹ç‚¹ï¼š**

- é¡¹ç›®çº§ç»“æ„å¯è¢«æ‰€æœ‰æµç¨‹å¼•ç”¨
- æµç¨‹çº§ç»“æ„å¯ä»¥é€šè¿‡"æå‡"æ“ä½œè½¬ä¸ºé¡¹ç›®çº§
- åŒä¸€ä½œç”¨åŸŸå†…ç»“æ„åç§°å”¯ä¸€

---

### 2. æ³›å‹æ”¯æŒ (Generics)

å‚è€ƒ Java æ³›å‹è®¾è®¡ï¼Œæ”¯æŒå®šä¹‰ç±»å‹å‚æ•°ï¼Œä½¿æ•°æ®ç»“æ„æ›´åŠ çµæ´»å’Œå¯å¤ç”¨ã€‚

#### æ³›å‹å‚æ•°é…ç½®

| å±æ€§       | è¯´æ˜                       | ç¤ºä¾‹                   |
| ---------- | -------------------------- | ---------------------- |
| **å‚æ•°å** | é€šå¸¸ä½¿ç”¨å•ä¸ªå¤§å†™å­—æ¯       | `T`, `E`, `K`, `V`     |
| **æè¿°**   | è¯´æ˜å‚æ•°çš„ç”¨é€”             | "æ•°æ®ç±»å‹"ã€"å…ƒç´ ç±»å‹" |
| **çº¦æŸ**   | å¯é€‰çš„ç±»å‹çº¦æŸï¼ˆæš‚æœªå®ç°ï¼‰ | `extends Comparable`   |

#### æ³›å‹å®ä¾‹åŒ–

åœ¨ä½¿ç”¨æ³›å‹ç»“æ„æ—¶ï¼Œéœ€è¦ä¸ºæ¯ä¸ªç±»å‹å‚æ•°æŒ‡å®šå…·ä½“ç±»å‹ï¼š

```typescript
// æ³›å‹å‚æ•°é…ç½®æ•°æ®ç»“æ„
{
  "T": {
    "isArray": false,        // æ˜¯å¦ä¸ºæ•°ç»„ç±»å‹
    "elementType": "string"  // å…·ä½“ç±»å‹ï¼šåŸºç¡€ç±»å‹æˆ–ç»“æ„å¼•ç”¨
  }
}
```

**æ”¯æŒçš„ç±»å‹ï¼š**

- åŸºç¡€ç±»å‹ï¼š`string`, `number`, `boolean`, `object`
- æ•°æ®ç»“æ„å¼•ç”¨ï¼š`struct:<structureId>`
- æ•°ç»„ç±»å‹ï¼š`isArray: true` + `elementType`

---

### 3. å­—æ®µå®šä¹‰ (Field Definition)

æ¯ä¸ªæ•°æ®ç»“æ„ç”±ä¸€ç»„å­—æ®µå®šä¹‰ç»„æˆï¼Œæ”¯æŒåµŒå¥—å’Œå¤æ‚ç±»å‹ã€‚

#### å­—æ®µå±æ€§

| å±æ€§           | ç±»å‹    | å¿…å¡« | è¯´æ˜                                                              |
| -------------- | ------- | ---- | ----------------------------------------------------------------- |
| `name`         | string  | âœ“    | å­—æ®µåç§°                                                          |
| `type`         | string  | âœ“    | å­—æ®µç±»å‹ï¼š`string`/`number`/`boolean`/`object`/`array`/æ³›å‹å‚æ•°å |
| `description`  | string  | -    | å­—æ®µè¯´æ˜                                                          |
| `required`     | boolean | -    | æ˜¯å¦å¿…å¡«                                                          |
| `example`      | any     | -    | ç¤ºä¾‹å€¼                                                            |
| `itemType`     | string  | -    | æ•°ç»„å…ƒç´ ç±»å‹ï¼ˆå½“ `type="array"` æ—¶ï¼‰                              |
| `itemFields`   | Field[] | -    | æ•°ç»„å…ƒç´ å­—æ®µï¼ˆå½“ `itemType="object"` æ—¶ï¼‰                         |
| `nestedFields` | Field[] | -    | åµŒå¥—å¯¹è±¡å­—æ®µï¼ˆå½“ `type="object"` æ—¶ï¼‰                             |

#### å­—æ®µç±»å‹è¯´æ˜

```typescript
// åŸºç¡€ç±»å‹
{ name: "username", type: "string", required: true }
{ name: "age", type: "number" }
{ name: "active", type: "boolean" }

// å¯¹è±¡ç±»å‹ï¼ˆåµŒå¥—ç»“æ„ï¼‰
{
  name: "profile",
  type: "object",
  nestedFields: [
    { name: "bio", type: "string" },
    { name: "avatar", type: "string" }
  ]
}

// æ•°ç»„ç±»å‹ï¼ˆåŸºç¡€å…ƒç´ ï¼‰
{
  name: "tags",
  type: "array",
  itemType: "string"
}

// æ•°ç»„ç±»å‹ï¼ˆå¯¹è±¡å…ƒç´ ï¼‰
{
  name: "items",
  type: "array",
  itemType: "object",
  itemFields: [
    { name: "id", type: "string" },
    { name: "name", type: "string" }
  ]
}

// æ³›å‹å‚æ•°ç±»å‹
{
  name: "data",
  type: "T",  // å¼•ç”¨æ³›å‹å‚æ•°
  description: "ä¸šåŠ¡æ•°æ®"
}
```

---

## æ•°æ®åº“è®¾è®¡

### è¡¨ç»“æ„ (data_structure)

```sql
CREATE TABLE data_structure (
    id TEXT PRIMARY KEY,
    project_id TEXT NOT NULL,
    flow_id TEXT,                      -- NULL è¡¨ç¤ºé¡¹ç›®çº§
    name TEXT NOT NULL,
    description TEXT,
    fields_json TEXT NOT NULL,         -- å­—æ®µå®šä¹‰çš„ JSON åºåˆ—åŒ–
    type_parameters_json TEXT,         -- æ³›å‹å‚æ•°çš„ JSON åºåˆ—åŒ–
    usage_count INTEGER DEFAULT 0,
    created_by TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_data_structure_project ON data_structure(project_id);
CREATE INDEX idx_data_structure_flow ON data_structure(flow_id);
CREATE UNIQUE INDEX idx_data_structure_name
    ON data_structure(project_id, COALESCE(flow_id, ''), name);
```

---

## åç«¯ API

### åŸºç¡€ CRUD

| æ–¹æ³•   | è·¯å¾„                                             | è¯´æ˜             |
| ------ | ------------------------------------------------ | ---------------- |
| POST   | `/api/projects/{projectId}/data-structures`      | åˆ›å»ºæ•°æ®ç»“æ„     |
| PUT    | `/api/projects/{projectId}/data-structures/{id}` | æ›´æ–°æ•°æ®ç»“æ„     |
| DELETE | `/api/projects/{projectId}/data-structures/{id}` | åˆ é™¤æ•°æ®ç»“æ„     |
| GET    | `/api/projects/{projectId}/data-structures/{id}` | è·å–å•ä¸ªæ•°æ®ç»“æ„ |

### æŸ¥è¯¢ API

| æ–¹æ³• | è·¯å¾„                                                                  | è¯´æ˜                                   |
| ---- | --------------------------------------------------------------------- | -------------------------------------- |
| GET  | `/api/projects/{projectId}/data-structures`                           | è·å–é¡¹ç›®çº§æ•°æ®ç»“æ„åˆ—è¡¨                 |
| GET  | `/api/projects/{projectId}/data-structures/flow/{flowId}`             | è·å–æµç¨‹çº§æ•°æ®ç»“æ„åˆ—è¡¨                 |
| GET  | `/api/projects/{projectId}/data-structures/grouped`                   | è·å–é¡¹ç›®ä¸‹æ‰€æœ‰æ•°æ®ç»“æ„ï¼ˆæŒ‰ä½œç”¨åŸŸåˆ†ç»„ï¼‰ |
| GET  | `/api/projects/{projectId}/data-structures/available?flowId={flowId}` | è·å–å¯ç”¨çš„æ•°æ®ç»“æ„ï¼ˆç”¨äºé€‰æ‹©å™¨ï¼‰       |

### é«˜çº§åŠŸèƒ½

| æ–¹æ³• | è·¯å¾„                                                           | è¯´æ˜                             |
| ---- | -------------------------------------------------------------- | -------------------------------- |
| POST | `/api/projects/{projectId}/data-structures/generate-from-json` | ä» JSON æ ·æœ¬ç”Ÿæˆæ•°æ®ç»“æ„         |
| POST | `/api/projects/{projectId}/data-structures/preview-from-json`  | é¢„è§ˆä» JSON ç”Ÿæˆçš„å­—æ®µï¼ˆä¸ä¿å­˜ï¼‰ |
| POST | `/api/projects/{projectId}/data-structures/{id}/copy`          | å¤åˆ¶æ•°æ®ç»“æ„åˆ°å¦ä¸€ä½œç”¨åŸŸ         |
| POST | `/api/projects/{projectId}/data-structures/{id}/promote`       | å°†æµç¨‹çº§ç»“æ„æå‡ä¸ºé¡¹ç›®çº§         |

---

## å‰ç«¯ä½¿ç”¨æ–¹å¼

### 1. æ•°æ®ç»“æ„ç®¡ç†ç•Œé¢

**å…¥å£ï¼š** ç³»ç»Ÿè®¾ç½® â†’ æ•°æ®ç»“æ„ç®¡ç†

**åŠŸèƒ½ï¼š**

- âœ… åˆ›å»º/ç¼–è¾‘/åˆ é™¤æ•°æ®ç»“æ„
- âœ… åˆ‡æ¢ä½œç”¨åŸŸï¼ˆé¡¹ç›®çº§/æµç¨‹çº§ï¼‰
- âœ… é…ç½®æ³›å‹å‚æ•°
- âœ… ä» JSON æ ·æœ¬è‡ªåŠ¨ç”Ÿæˆ
- âœ… æå‡ä¸ºé¡¹ç›®çº§
- âœ… æŸ¥çœ‹å¼•ç”¨æ¬¡æ•°

**ç»„ä»¶è·¯å¾„ï¼š**

```
flowlet-frontend/src/components/DataStructureManager/
â”œâ”€â”€ DataStructureManager.tsx      # ä¸»ç®¡ç†ç•Œé¢
â”œâ”€â”€ DataStructureDrawer.tsx       # åˆ›å»º/ç¼–è¾‘æŠ½å±‰
â”œâ”€â”€ FieldEditor.tsx               # å­—æ®µç¼–è¾‘å™¨
â””â”€â”€ index.ts
```

---

### 2. åœ¨èŠ‚ç‚¹é…ç½®ä¸­ä½¿ç”¨

#### API èŠ‚ç‚¹ - è¾“å‡ºç»“æ„é…ç½®

**ä½ç½®ï¼š** API èŠ‚ç‚¹é…ç½®é¢æ¿ â†’ è¾“å‡ºç»“æ„å®šä¹‰

**é…ç½®æ­¥éª¤ï¼š**

1. **å¯ç”¨æ•°æ®ç»“æ„ï¼š** æ‰“å¼€"ä½¿ç”¨æ•°æ®ç»“æ„"å¼€å…³
2. **é€‰æ‹©ç»“æ„ï¼š** ä»ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©å·²å®šä¹‰çš„æ•°æ®ç»“æ„
   - é¡¹ç›®çº§ç»“æ„æ ‡è®°ä¸º `global`
   - å½“å‰æµç¨‹ç»“æ„é«˜äº®æ˜¾ç¤º
   - å…¶ä»–æµç¨‹ç»“æ„æ˜¾ç¤ºæµç¨‹åæ ‡ç­¾
3. **é…ç½®æ³›å‹å‚æ•°ï¼ˆå¦‚æœæ˜¯æ³›å‹ç»“æ„ï¼‰ï¼š**
   - ä¸ºæ¯ä¸ªæ³›å‹å‚æ•°ï¼ˆå¦‚ `T`ï¼‰æŒ‡å®šå…·ä½“ç±»å‹
   - å‹¾é€‰ `List` å¤é€‰æ¡†è¡¨ç¤ºæ•°ç»„ç±»å‹
   - é€‰æ‹©å…ƒç´ ç±»å‹ï¼ˆåŸºç¡€ç±»å‹æˆ–æ•°æ®ç»“æ„ï¼‰
4. **è®¾ç½®è¾“å‡ºåˆ«åï¼ˆå¯é€‰ï¼‰ï¼š** ä¸ºèŠ‚ç‚¹è¾“å‡ºè®¾ç½®å…¨å±€å˜é‡åˆ«å

**ç¤ºä¾‹é…ç½®ï¼š**

å‡è®¾æœ‰æ³›å‹ç»“æ„ `ResultVO<T>`ï¼š

```json
{
  "code": "string",
  "message": "string",
  "data": "T"
}
```

åœ¨ API èŠ‚ç‚¹ä¸­é…ç½®ï¼š

- é€‰æ‹©ç»“æ„ï¼š`ResultVO<T>`
- æ³›å‹å‚æ•°é…ç½®ï¼š
  - `T` â†’ å‹¾é€‰ `List` â†’ é€‰æ‹© `BusinessVO`
- è¾“å‡ºåˆ«åï¼š`apiResult`

æœ€ç»ˆç±»å‹ï¼š`ResultVO<List<BusinessVO>>`

**ç»„ä»¶è·¯å¾„ï¼š**

```
flowlet-frontend/src/components/NodeConfigPanel/components/
â””â”€â”€ OutputSchemaConfig.tsx    # è¾“å‡ºç»“æ„é…ç½®ç»„ä»¶
```

---

### 3. åœ¨åç»­èŠ‚ç‚¹ä¸­å¼•ç”¨è¾“å‡º

#### é€šè¿‡è¾“å‡ºåˆ«åå¼•ç”¨

å¦‚æœèŠ‚ç‚¹è®¾ç½®äº†è¾“å‡ºåˆ«åï¼ˆå¦‚ `apiResult`ï¼‰ï¼Œåç»­èŠ‚ç‚¹å¯ä»¥é€šè¿‡åˆ«åå¼•ç”¨ï¼š

**å˜é‡é€‰æ‹©å™¨ä¸­ä¼šæ˜¾ç¤ºï¼š**

```
ğŸ·ï¸ apiResult
  â”œâ”€ code          (string)
  â”œâ”€ message       (string)
  â””â”€ data          (List<BusinessVO>)
```

**åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼š**

```javascript
// è®¿é—®å“åº”ç 
{
  {
    apiResult.code;
  }
}

// è®¿é—®æ•°æ®åˆ—è¡¨
{
  {
    apiResult.data;
  }
}

// è®¿é—®åˆ—è¡¨ä¸­çš„å­—æ®µï¼ˆéœ€è¦é…åˆå¾ªç¯/è½¬æ¢èŠ‚ç‚¹ï¼‰
{
  {
    apiResult.data[0].businessName;
  }
}
```

#### ç›´æ¥å¼•ç”¨èŠ‚ç‚¹è¾“å‡º

å¦‚æœæ²¡æœ‰è®¾ç½®è¾“å‡ºåˆ«åï¼Œé€šè¿‡èŠ‚ç‚¹åç§°å¼•ç”¨ï¼š

**å˜é‡é€‰æ‹©å™¨ä¸­ä¼šæ˜¾ç¤ºï¼š**

```
API è°ƒç”¨èŠ‚ç‚¹ 1
  â”œâ”€ statusCode    (number)
  â”œâ”€ headers       (object)
  â”œâ”€ body          (object)  â† è¿™é‡Œæ˜¯ç»“æ„åŒ–çš„æ•°æ®
  â””â”€ error         (string)
```

**æ³¨æ„ï¼š** å¦‚æœé…ç½®äº†è¾“å‡ºç»“æ„ï¼Œ`body` å­—æ®µå°†è‡ªåŠ¨å±•å¼€ä¸ºç»“æ„åŒ–å­—æ®µã€‚

---

### 4. æ•°æ®ç»“æ„åœ¨å˜é‡ç³»ç»Ÿä¸­çš„é›†æˆ

**å½“å‰é›†æˆç‚¹ï¼š** `flowlet-frontend/src/utils/flowUtils.ts`

**æ ¸å¿ƒå‡½æ•°ï¼š** `buildAvailableVariables()`

**TODOï¼ˆå¾…å®ç°ï¼‰ï¼š**

- [ ] ä» `outputStructureId` è¯»å–ç»“æ„å®šä¹‰
- [ ] æ ¹æ® `genericTypeArgs` å®ä¾‹åŒ–æ³›å‹å‚æ•°
- [ ] å±•å¼€ç»“æ„åŒ–å­—æ®µåˆ°å˜é‡é€‰æ‹©å™¨
- [ ] æ”¯æŒåµŒå¥—å­—æ®µçš„è·¯å¾„å¼•ç”¨ï¼ˆå¦‚ `data.businessName`ï¼‰

**é¢„æœŸæ•ˆæœï¼ˆå®ç°åï¼‰ï¼š**

```typescript
// èŠ‚ç‚¹é…ç½®
{
  outputStructureId: "result-vo-id",
  genericTypeArgs: {
    T: { isArray: true, elementType: "struct:business-vo-id" }
  },
  outputAlias: "apiResult"
}

// å˜é‡é€‰æ‹©å™¨æ˜¾ç¤º
ğŸ·ï¸ apiResult
  â”œâ”€ code          (string) - å“åº”ç 
  â”œâ”€ message       (string) - å“åº”æ¶ˆæ¯
  â””â”€ data          (List<BusinessVO>) - ä¸šåŠ¡æ•°æ®
      â”œâ”€ businessName   (string)
      â”œâ”€ businessType   (string)
      â””â”€ createdAt      (string)
```

---

## å…¸å‹ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šå®šä¹‰é€šç”¨ API å“åº”ç»“æ„

**æ­¥éª¤ï¼š**

1. åˆ›å»ºé¡¹ç›®çº§æ³›å‹ç»“æ„ `Result<T>`ï¼š

   ```json
   {
     "name": "Result",
     "scope": "é¡¹ç›®çº§",
     "isGeneric": true,
     "typeParameters": [{ "name": "T", "description": "æ•°æ®ç±»å‹" }],
     "fields": [
       { "name": "code", "type": "string", "required": true },
       { "name": "message", "type": "string" },
       { "name": "data", "type": "T" },
       { "name": "timestamp", "type": "number" }
     ]
   }
   ```

2. åˆ›å»ºä¸šåŠ¡æ•°æ®ç»“æ„ `UserVO`ï¼š

   ```json
   {
     "name": "UserVO",
     "scope": "é¡¹ç›®çº§",
     "fields": [
       { "name": "id", "type": "string", "required": true },
       { "name": "username", "type": "string", "required": true },
       { "name": "email", "type": "string" },
       { "name": "createdAt", "type": "string" }
     ]
   }
   ```

3. åœ¨ API èŠ‚ç‚¹ä¸­ä½¿ç”¨ï¼š

   - é€‰æ‹©è¾“å‡ºç»“æ„ï¼š`Result<T>`
   - é…ç½®æ³›å‹ï¼š`T` = `UserVO`
   - è®¾ç½®åˆ«åï¼š`userResult`

4. åç»­èŠ‚ç‚¹å¼•ç”¨ï¼š`{{userResult.data.username}}`

---

### åœºæ™¯ 2ï¼šä» API å“åº”è‡ªåŠ¨ç”Ÿæˆç»“æ„

**æ­¥éª¤ï¼š**

1. è°ƒç”¨ API è·å–å®é™…å“åº” JSON
2. æ‰“å¼€æ•°æ®ç»“æ„ç®¡ç†ç•Œé¢
3. ç‚¹å‡»"ä» JSON ç”Ÿæˆ"
4. ç²˜è´´ JSON æ ·æœ¬ï¼š
   ```json
   {
     "id": "123",
     "name": "Product A",
     "price": 99.99,
     "tags": ["electronics", "featured"],
     "inventory": {
       "warehouse": "WH-001",
       "quantity": 50
     }
   }
   ```
5. ç³»ç»Ÿè‡ªåŠ¨æ¨æ–­å­—æ®µç±»å‹å¹¶ç”Ÿæˆç»“æ„
6. è°ƒæ•´å­—æ®µï¼ˆæ ‡è®°å¿…å¡«ã€æ·»åŠ æè¿°ç­‰ï¼‰
7. ä¿å­˜å¹¶åœ¨èŠ‚ç‚¹ä¸­ä½¿ç”¨

---

### åœºæ™¯ 3ï¼šæµç¨‹å†…ä¸´æ—¶ç»“æ„æå‡ä¸ºå…¨å±€

**èƒŒæ™¯ï¼š** æŸä¸ªæµç¨‹ä¸­å®šä¹‰äº†ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œåæ¥å‘ç°å…¶ä»–æµç¨‹ä¹Ÿéœ€è¦ä½¿ç”¨ã€‚

**æ­¥éª¤ï¼š**

1. è¿›å…¥æ•°æ®ç»“æ„ç®¡ç†ç•Œé¢
2. æ‰¾åˆ°è¯¥æµç¨‹çº§ç»“æ„
3. ç‚¹å‡»"æå‡ä¸ºé¡¹ç›®çº§"
4. ç³»ç»Ÿè‡ªåŠ¨æ£€æŸ¥åç§°å†²çª
5. æå‡åï¼Œæ‰€æœ‰æµç¨‹éƒ½å¯ä»¥ä½¿ç”¨è¯¥ç»“æ„

---

## æœ€ä½³å®è·µ

### 1. å‘½åè§„èŒƒ

| ç±»å‹      | å‘½åå»ºè®®                       | ç¤ºä¾‹                                              |
| --------- | ------------------------------ | ------------------------------------------------- |
| å®ä½“ç±»    | ä½¿ç”¨ä¸šåŠ¡åè¯                   | `User`, `Order`, `Product`                        |
| å€¼å¯¹è±¡    | æ·»åŠ  `VO` åç¼€                 | `UserVO`, `OrderDetailVO`                         |
| è¯·æ±‚/å“åº” | æ·»åŠ  `Request`/`Response` åç¼€ | `CreateUserRequest`, `ApiResponse`                |
| é€šç”¨å®¹å™¨  | ä½¿ç”¨æ³›å‹ï¼Œç®€æ´å‘½å             | `Result<T>`, `Page<T>`, `List<T>`                 |
| æ³›å‹å‚æ•°  | å•ä¸ªå¤§å†™å­—æ¯ï¼Œè¯­ä¹‰åŒ–           | `T` (Type), `E` (Element), `K` (Key), `V` (Value) |

### 2. ä½œç”¨åŸŸé€‰æ‹©

- **ä¼˜å…ˆä½¿ç”¨é¡¹ç›®çº§ï¼š** å¯¹äºé€šç”¨çš„ã€å¯å¤ç”¨çš„ç»“æ„
- **æµç¨‹çº§ä»…ç”¨äºä¸´æ—¶ç»“æ„ï¼š** æµç¨‹ç‰¹å®šçš„ã€ä¸€æ¬¡æ€§çš„æ•°æ®æ ¼å¼
- **éšæ—¶æå‡ï¼š** å‘ç°å¤ç”¨ä»·å€¼æ—¶ï¼ŒåŠæ—¶æå‡ä¸ºé¡¹ç›®çº§

### 3. æ³›å‹è®¾è®¡

- **å•ä¸€èŒè´£ï¼š** ä¸€ä¸ªæ³›å‹å‚æ•°åªè¡¨ç¤ºä¸€ç§ç±»å‹
- **åˆç†å‘½åï¼š** `T` è¡¨ç¤ºä¸»è¦æ•°æ®ç±»å‹ï¼Œ`E` è¡¨ç¤ºé›†åˆå…ƒç´ 
- **æ–‡æ¡£è¯´æ˜ï¼š** åœ¨æ³›å‹å‚æ•°æè¿°ä¸­è¯´æ˜ç”¨é€”å’Œçº¦æŸ
- **é¿å…è¿‡åº¦ï¼š** ä¸è¦å®šä¹‰è¶…è¿‡ 3 ä¸ªæ³›å‹å‚æ•°

### 4. å­—æ®µå®šä¹‰

- **å¿…å¡«æ ‡è®°ï¼š** æ˜ç¡®æ ‡è®°å¿…å¡«å­—æ®µ
- **æ·»åŠ æè¿°ï¼š** ä¸ºæ¯ä¸ªå­—æ®µæ·»åŠ æ¸…æ™°çš„è¯´æ˜
- **ç¤ºä¾‹å€¼ï¼š** æä¾›å®é™…çš„ç¤ºä¾‹æ•°æ®
- **ç±»å‹å‡†ç¡®ï¼š** ä½¿ç”¨ç²¾ç¡®çš„ç±»å‹ï¼Œé¿å…å…¨éƒ¨ç”¨ `string`

### 5. ç‰ˆæœ¬ç®¡ç†

- **è°¨æ…ä¿®æ”¹ï¼š** ä¿®æ”¹å·²è¢«å¼•ç”¨çš„ç»“æ„æ—¶è¦å°å¿ƒ
- **å‘åå…¼å®¹ï¼š** æ·»åŠ å­—æ®µé€šå¸¸å®‰å…¨ï¼Œåˆ é™¤å­—æ®µéœ€è¯„ä¼°å½±å“
- **å¤åˆ¶ä»£æ›¿ä¿®æ”¹ï¼š** é‡å¤§å˜æ›´æ—¶ï¼Œè€ƒè™‘åˆ›å»ºæ–°ç‰ˆæœ¬ï¼ˆå¦‚ `UserV2`ï¼‰

---

## æœªæ¥è§„åˆ’

### çŸ­æœŸï¼ˆv1.1ï¼‰

- [ ] åœ¨å˜é‡é€‰æ‹©å™¨ä¸­å®Œæ•´å±•ç¤ºç»“æ„åŒ–å­—æ®µ
- [ ] æ”¯æŒç»“æ„åŒ–æ•°æ®çš„å¯è§†åŒ–é¢„è§ˆ
- [ ] èŠ‚ç‚¹é…ç½®éªŒè¯ï¼ˆæ ¹æ®è¾“å‡ºç»“æ„æ ¡éªŒæ•°æ®ï¼‰

### ä¸­æœŸï¼ˆv1.2ï¼‰

- [ ] æ³›å‹çº¦æŸæ”¯æŒï¼ˆextendsã€implementsï¼‰
- [ ] ç»“æ„ç»§æ‰¿/ç»„åˆ
- [ ] ä» OpenAPI/Swagger å¯¼å…¥ç»“æ„
- [ ] ç»“æ„ç‰ˆæœ¬ç®¡ç†

### é•¿æœŸï¼ˆv2.0ï¼‰

- [ ] è¿è¡Œæ—¶ç±»å‹æ ¡éªŒ
- [ ] è‡ªåŠ¨ç±»å‹è½¬æ¢
- [ ] IDE å¼çš„æ™ºèƒ½æç¤ºå’Œè¡¥å…¨
- [ ] ç»“æ„å½±å“åˆ†æå’Œå¯è§†åŒ–

---

## å¸¸è§é—®é¢˜

### Q1ï¼šä¿®æ”¹å·²ä½¿ç”¨çš„æ•°æ®ç»“æ„ä¼šå½±å“ä»€ä¹ˆï¼Ÿ

**Aï¼š** å½“å‰ç³»ç»Ÿä¼šè®°å½• `usage_count`ï¼Œä½†å°šæœªå®ç°å®Œæ•´çš„å½±å“åˆ†æã€‚å»ºè®®ï¼š

- æŸ¥çœ‹å¼•ç”¨æ¬¡æ•°åå†ä¿®æ”¹
- æ·»åŠ å­—æ®µé€šå¸¸å®‰å…¨
- åˆ é™¤æˆ–ä¿®æ”¹å­—æ®µç±»å‹éœ€è¦æ‰‹åŠ¨æ£€æŸ¥ä½¿ç”¨è¯¥ç»“æ„çš„èŠ‚ç‚¹

### Q2ï¼šæ³›å‹å‚æ•°å¯ä»¥åµŒå¥—å—ï¼ˆå¦‚ `List<List<T>>`ï¼‰ï¼Ÿ

**Aï¼š** å½“å‰ç‰ˆæœ¬æ”¯æŒä¸€çº§æ•°ç»„ï¼ˆ`List<T>`ï¼‰ï¼Œä¸æ”¯æŒå¤šçº§åµŒå¥—ã€‚å¯ä»¥é€šè¿‡ï¼š

1. å®šä¹‰ä¸­é—´ç»“æ„ï¼š`ArrayWrapper<T>` åŒ…å«å­—æ®µ `items: T[]`
2. ä½¿ç”¨ `object` ç±»å‹ä½œä¸ºä¸´æ—¶æ–¹æ¡ˆ

### Q3ï¼šå¦‚ä½•å¤„ç†é€’å½’ç»“æ„ï¼ˆå¦‚æ ‘å½¢ç»“æ„ï¼‰ï¼Ÿ

**Aï¼š** å½“å‰ä¸æ”¯æŒç›´æ¥é€’å½’å®šä¹‰ã€‚å»ºè®®ï¼š

- ä½¿ç”¨ `object` ç±»å‹è¡¨ç¤ºé€’å½’éƒ¨åˆ†
- åœ¨æè¿°ä¸­è¯´æ˜é€’å½’å…³ç³»
- æœªæ¥ç‰ˆæœ¬ä¼šæ”¯æŒç»“æ„å¼•ç”¨

### Q4ï¼šæ•°æ®ç»“æ„èƒ½å¦å¯¼å‡º/å¯¼å…¥ï¼Ÿ

**Aï¼š** å½“å‰éœ€è¦æ‰‹åŠ¨å¤åˆ¶ã€‚è®¡åˆ’åœ¨ v1.2 ç‰ˆæœ¬æ”¯æŒï¼š

- å¯¼å‡ºä¸º JSON Schema
- ä» OpenAPI/Swagger å¯¼å…¥
- è·¨é¡¹ç›®å¤åˆ¶ç²˜è´´

---

## ç›¸å…³æ–‡æ¡£

- [è®¤è¯ç³»ç»Ÿè®¾è®¡](./AUTH_SYSTEM.md)
- [æµç¨‹æ‰§è¡Œå¼•æ“](./ENGINE_DESIGN.md)
- [å˜é‡ä¸è¡¨è¾¾å¼ç³»ç»Ÿ](./VARIABLE_SYSTEM.md)

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025-12-25  
**ç»´æŠ¤è€…ï¼š** Flowlet Team
